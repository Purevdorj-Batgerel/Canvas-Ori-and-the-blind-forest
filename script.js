function T(){return Math.abs((Math.random()+Math.random()+Math.random()+Math.random()+Math.random()+Math.random()-3)/3)}function R(e){return e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2}function y(e,t,i,a){let r=[],l=i.split(" "),o="",s="",h=0,x=1.4;return l.forEach(c=>{s=o+c+" ",e.measureText(s).width>a?(h=(r.length+1)*t*x,r.push({text:o,height:h}),o=c+" "):o=s}),o.length>0&&(h=(r.length+1)*t*x,r.push({text:o.trim(),height:h})),r}function D(){let e=1080/window.innerHeight,t=1780/window.innerWidth;return Math.min(e,t)}document.body.style.position="fixed";document.body.style.margin=0;document.body.style.font="12px Montserrat";var S=document.createElement("canvas"),E=document.createElement("canvas"),b=document.createElement("canvas"),z=[S,E,b],H=new Image,O=new Image,V=new Image;H.src="./assets/bg_back_32.png";O.src="./assets/bg_mid_64.png";V.src="./assets/bg_fore_32.png";var m=new Audio("./assets/ori_main_theme.mp3"),C=new Image,P=new Image;C.src="./assets/logo1.png";P.src="./assets/raster.png";var _=S.getContext("2d",{alpha:!1}),w=E.getContext("2d"),n=b.getContext("2d"),$=1e3,X="Main Theme - Definitive Edition",Y="Gareth Coker",Z="Ori and the Blind Forest",W=0,A=0,d,f=0,I=0,u=1,k=!1,v=1,L=60,G=48,j=Math.floor(window.innerHeight*window.innerWidth/4e4),g=new Array(j);g.fill({});g=g.map(e=>({x:Math.floor(Math.random()*window.innerWidth),y:Math.floor(Math.random()*window.innerHeight),r:Math.floor(T()*100+6),angle:Math.random()*360}));var J=e=>{e.forEach((t,i)=>{t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.zIndex=i})},N=e=>{e.forEach(t=>{t.width=window.innerWidth,t.height=window.innerHeight})},F=e=>{let{beta:t,gamma:i}=e;i>45?i=45:i<-45&&(i=-45),t>45?t=45:t<-45&&(t=-45),window.innerHeight>window.innerWidth?f=i:f=t},U=()=>{v=D()},q=e=>{K(),Q(),I&&u&&p(e),window.requestAnimationFrame(q)},ee=()=>{g=g.map((e,t)=>{e.angle+=.01,e.y-=.02*e.r;let i=Math.sin(e.angle)/4*(e.r/20);return e.x+=i,e.x>window.innerWidth+e.r*2||e.x<-e.r*2||e.y<-e.r*2?t%3>0?{x:Math.random()*window.innerWidth,y:window.innerHeight+e.r*2,r:e.r,angle:e.angle}:i>0?{x:-e.r*2+1,y:Math.random()*window.innerHeight,r:e.r,angle:e.angle}:{x:window.innerWidth+e.r*2-1,y:Math.random()*window.innerHeight,r:e.r,angle:e.angle}:e})},te=()=>{ee(),g.forEach(e=>{let t=w.createRadialGradient(e.x,e.y,0,e.x,e.y,e.r),i=Math.sqrt((e.x-W)*(e.x-W)+(e.y-A)*(e.y-A));i>100?(t.addColorStop(0,"rgba(255,255,164,.7)"),t.addColorStop(.4,"rgba(247,148,29,.3)"),t.addColorStop(1,"rgba(255,218,164,0)")):(t.addColorStop(0,`rgba(255,255,164,${.7+.3*(100-i)/100})`),t.addColorStop(.4,`rgba(247,148,29,${.3+.4*(100-i)/100})`),t.addColorStop(1,"rgba(255,218,164,0)")),w.fillStyle=t,w.fillRect(e.x-e.r,e.y-e.r,e.r*2,e.r*2)})},ne=()=>{window.innerWidth>1599?d.fftSize=2048:window.innerWidth<600?d.fftSize=512:d.fftSize=1024;let e=d.frequencyBinCount,t=new Uint8Array(e);d.getByteFrequencyData(t);let i=window.innerWidth/e,a,r=0;w.fillStyle="rgba(255, 255, 255,.5)";for(let l=0;l<e;l++)a=t[l],w.fillRect(r,window.innerHeight-a,i,a),r+=i+1},ie=()=>{let e=window.innerWidth-40,t=Math.min(36,window.innerHeight/12),i=X;n.font=`${t}px Montserrat`,n.fillStyle="white",n.textAlign="center";let a=y(n,t,i,e),r=0,l=0;a.forEach(o=>{l=o.height,n.fillText(o.text.trim(),window.innerWidth/2,window.innerHeight*.65+r+l)}),r+=l+4,t=Math.min(27,window.innerHeight/12*.75),n.font=`${t}px Montserrat`,i=Z,a=y(n,t,i,e),a.forEach(o=>{l=o.height,n.fillText(o.text,window.innerWidth/2,window.innerHeight*.65+r+l)}),r+=l+4,i=Y,n.font=`bold ${t}px Montserrat`,a=y(n,t,i,e),a.forEach(o=>{l=o.height,n.fillText(o.text,window.innerWidth/2,window.innerHeight*.65+r+l)})},K=()=>{let e=Math.ceil(H.naturalWidth/v),t=Math.ceil(H.naturalHeight/v),i=(window.innerWidth-e)/2,a=Math.ceil((window.innerHeight-t)/2);_.drawImage(H,Math.ceil(i-f*.3),a,e,t),_.drawImage(O,Math.ceil(i+f*.2),a,e,t),_.drawImage(V,Math.ceil(i+f*.7),a,e,t)},Q=()=>{w.clearRect(0,0,window.innerWidth,window.innerHeight),te(),d&&ne()},p=e=>{n.clearRect(0,0,window.innerWidth,window.innerHeight);let t=v+.5,i=C.naturalWidth/t,a=C.naturalHeight/t,r=(window.innerWidth-i)/2,l=-50/t;n.drawImage(C,r,l,i,a);let o=Math.max(window.innerWidth,window.innerHeight)/2;n.save();let s=n.createRadialGradient(o,o,0,o,o,o*1.4);s.addColorStop(0,"transparent"),s.addColorStop(.7,"transparent"),s.addColorStop(.95,"black"),s.addColorStop(1,"black"),n.fillStyle=s;let h=window.innerHeight/window.innerWidth,x=window.innerWidth/window.innerHeight;if(n.setTransform(Math.min(1,x),0,0,Math.min(1,h),0,0),n.fillRect(0,0,o*2,o*2),n.restore(),e){let M=(e-I)/$;if(M<0)return;M>1?(M=1,u=0):u=1-R(M)}n.save(),n.globalAlpha=u,n.fillStyle="white";let c=5+v;n.scale(1/c,1/c),n.translate((window.innerWidth-75)*c/2,window.innerHeight*.85*c),n.fill(new Path2D("M319 188h-1c-9 0-18 3-24 9-6-15-20-26-36-26-10 0-20 4-27 11-6-13-19-21-34-21-8-1-16 2-22 7V76c0-23-18-41-39-41S98 53 98 76v182l-10-12c-10-11-23-18-37-19-15-1-28 3-39 13l-9 8c-3 2-4 6-2 9l88 169c16 30 46 50 79 50h99v-1c50 0 90-43 90-96V228c0-23-17-40-38-40zm22 135v56c0 44-34 81-75 81h-98c-27 0-52-16-65-42L18 256l5-4a36 36 0 0152 4l25 30a8 8 0 0014-5V76c0-14 10-25 22-25s23 11 23 25v178a8 8 0 0016 0v-54c0-13 10-23 22-23 13 0 23 10 23 24v48a8 8 0 0016 0v-38c0-13 9-24 22-24 12 0 22 11 22 24v36a8 8 0 0016 0v-19c0-14 10-24 22-24h1c12 0 22 10 22 24v95zm0 0")),n.fill(new Path2D("M73 79c4 0 8-3 8-8a55 55 0 01110 0 8 8 0 0016 0 71 71 0 00-142 0c0 5 3 8 8 8zm0 0")),n.restore(),n.save(),n.globalAlpha=1-u,ie(),n.save(),n.fillStyle="white",n.scale(2,2),n.translate(24/2,24/2),m.muted?n.fill(new Path2D("M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z")):n.fill(new Path2D("M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z")),n.restore(),n.restore(),n.save(),n.fillStyle="white",n.scale(2.5,2.5),n.translate((window.innerWidth-16-L)/2.5,16/2.5),document.fullscreenElement?n.fill(new Path2D("M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3")):n.fill(new Path2D("M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z")),n.restore(),n.save();let B=n.createPattern(P,"repeat");n.fillStyle=B,n.globalAlpha=.5,n.fillRect(0,0,window.innerWidth,window.innerHeight),n.restore()},oe=()=>{I=performance.now();let e=m.play();e&&e.then(t=>{k=!0;let i=new(window.AudioContext||window.webkitAudioContext);d=i.createAnalyser(),d.minDecibels=-110,d.maxDecibels=-30,d.smoothingTimeConstant=.88,i.createMediaElementSource(m).connect(d),d.connect(i.destination)}).catch(t=>{console.log(t)})},ae=e=>{let{clientX:t,clientY:i}=e;window.innerWidth-L-16<t&&t<window.innerWidth-16&&i>16&&i<16+L?document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen():16<t&&t<16+G&&16<i&&i<16+G?(m.muted=!m.muted,p()):k||oe()};window.onload=()=>{document.body.appendChild(S),document.body.appendChild(E),document.body.appendChild(b),document.fonts.ready.then(function(){p()}),b.addEventListener("click",ae),window.addEventListener("resize",()=>{N(z),U(),p()}),window.addEventListener("deviceorientation",F),window.addEventListener("mousemove",e=>{W=e.x,A=e.y;let t=W*100/window.innerWidth-50;F({beta:t,gamma:t})}),J(z),N(z),U(),q()};
